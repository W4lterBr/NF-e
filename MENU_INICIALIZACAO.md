# ğŸš€ Menu de InicializaÃ§Ã£o Implementado

## ğŸ“ LocalizaÃ§Ã£o

O menu de inicializaÃ§Ã£o estÃ¡ em:

```
Menu Principal â†’ ConfiguraÃ§Ãµes â†’ ğŸš€ InicializaÃ§Ã£o
```

## ğŸ¯ Estrutura do Menu

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ğŸ“‹ ConfiguraÃ§Ãµes                                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Atualizar                                        F5        â•‘
â•‘ ğŸ”„ Sincronizar XMLs                         Ctrl+Shift+S   â•‘
â•‘ ğŸ“¥ Baixar XMLs Faltantes                    Ctrl+Shift+D   â•‘
â•‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘ Buscar na SEFAZ                                 Ctrl+B     â•‘
â•‘ Busca Completa                              Ctrl+Shift+B   â•‘
â•‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘ Busca por chave                                 Ctrl+K     â•‘
â•‘ ğŸ“¤ Exportar                                     Ctrl+E     â•‘
â•‘ Certificadosâ€¦                               Ctrl+Shift+C   â•‘
â•‘ ğŸ“ Importar XMLs                                Ctrl+I     â•‘
â•‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘ âš™ï¸ Gerenciador de Trabalhos                Ctrl+Shift+G   â•‘
â•‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘ ğŸ’¾ Armazenamentoâ€¦                           Ctrl+Shift+A   â•‘
â•‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘ â±ï¸ Intervalo de Busca AutomÃ¡tica          â–¶               â•‘
â•‘    â”œâ”€ 1 hora                                               â•‘
â•‘    â”œâ”€ 2 horas                                              â•‘
â•‘    â”œâ”€ 3 horas                                              â•‘
â•‘    â”œâ”€ 4 horas                                              â•‘
â•‘    â”œâ”€ 6 horas                                              â•‘
â•‘    â”œâ”€ 8 horas                                              â•‘
â•‘    â”œâ”€ 12 horas                                             â•‘
â•‘    â”œâ”€ 16 horas                                             â•‘
â•‘    â”œâ”€ 20 horas                                             â•‘
â•‘    â””â”€ 23 horas                                             â•‘
â•‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘ ğŸš€ InicializaÃ§Ã£o                           â–¶               â•‘  â—„â”€â”€ NOVO!
â•‘    â”œâ”€ â˜‘ï¸ Iniciar automaticamente com o Windows            â•‘
â•‘    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â•‘
â•‘    â”œâ”€ â±ï¸ Gerenciador de Tarefas Agendadas                 â•‘
â•‘    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â•‘
â•‘    â””â”€ â„¹ï¸ Busca automÃ¡tica apÃ³s 10 minutos (modo startup)  â•‘
â•‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘ ğŸ”„ AtualizaÃ§Ãµes                                 Ctrl+U     â•‘
â•‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘ Limpar                                      Ctrl+Shift+L   â•‘
â•‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘ Abrir XMLs                                  Ctrl+Shift+X   â•‘
â•‘ Abrir logs                                      Ctrl+L     â•‘
â•‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘ Usar PDF simples (modo seguro)                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## âœ¨ Funcionalidades do Submenu

### 1. â˜‘ï¸ Iniciar automaticamente com o Windows

- **Tipo**: Checkbox (marcÃ¡vel/desmarcÃ¡vel)
- **FunÃ§Ã£o**: Habilita/desabilita inicializaÃ§Ã£o automÃ¡tica
- **Status**: Mostra estado atual (marcado = ativo)
- **Registro**: Cria entrada em `HKCU\...\Run`

**Quando ativado:**
- âœ… Aplicativo inicia com Windows
- âœ… Fica na bandeja do sistema
- âœ… Agenda busca automÃ¡tica para 10 minutos
- âœ… Aparece em ConfiguraÃ§Ãµes > Aplicativos > InicializaÃ§Ã£o

**Quando desativado:**
- âŒ NÃ£o inicia automaticamente
- âŒ Remove entrada do registro

### 2. â±ï¸ Gerenciador de Tarefas Agendadas

- **Tipo**: AÃ§Ã£o (clique Ãºnico)
- **FunÃ§Ã£o**: Abre janela do gerenciador
- **Atalho**: TambÃ©m disponÃ­vel no menu da bandeja

**O que mostra:**
- ğŸ“‹ Lista de tarefas agendadas
- â±ï¸ Countdown em tempo real
- â–¶ï¸ Status (Agendada/Em execuÃ§Ã£o/Cancelada)
- âŒ BotÃ£o para cancelar tarefas

### 3. â„¹ï¸ Busca automÃ¡tica apÃ³s 10 minutos

- **Tipo**: Informativo (nÃ£o clicÃ¡vel)
- **FunÃ§Ã£o**: Informa sobre comportamento do modo startup
- **Detalhes**: 
  - Busca executada automaticamente
  - Apenas quando inicia via `--startup`
  - Timer de 600 segundos (10 minutos)

## ğŸ”„ SincronizaÃ§Ã£o

O menu estÃ¡ sincronizado com:

1. **Menu da Bandeja (System Tray)**
   - Mesma funcionalidade
   - Estado compartilhado
   - AtualizaÃ§Ã£o automÃ¡tica

2. **Registro do Windows**
   - Leitura do estado atual
   - Escrita ao alternar
   - ValidaÃ§Ã£o automÃ¡tica

3. **Task Scheduler**
   - Gerenciador compartilhado
   - Tarefas visÃ­veis em ambos

## ğŸ¨ Comportamento Visual

### Estado Marcado (âœ“)
```
â˜‘ï¸ Iniciar automaticamente com o Windows
```
- Checkbox marcado
- Indica que estÃ¡ ativo
- Verde/destaque (tema padrÃ£o)

### Estado Desmarcado
```
â˜ Iniciar automaticamente com o Windows
```
- Checkbox vazio
- Indica que estÃ¡ desabilitado
- Cinza/normal

## ğŸ’¬ Mensagens ao UsuÃ¡rio

### Ao Ativar:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ InicializaÃ§Ã£o AutomÃ¡tica Ativada           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“ O aplicativo agora iniciarÃ¡              â”‚
â”‚   automaticamente com o Windows.            â”‚
â”‚                                             â”‚
â”‚ â€¢ AparecerÃ¡ apenas na bandeja do sistema   â”‚
â”‚ â€¢ Busca automÃ¡tica serÃ¡ executada apÃ³s     â”‚
â”‚   10 minutos                                â”‚
â”‚ â€¢ VocÃª pode desabilitar a qualquer momento â”‚
â”‚                                             â”‚
â”‚ Verifique em:                               â”‚
â”‚ ConfiguraÃ§Ãµes do Windows >                  â”‚
â”‚ Aplicativos > InicializaÃ§Ã£o                 â”‚
â”‚                                             â”‚
â”‚                 [ OK ]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ao Desativar:
```
Status Bar: "âœ“ InicializaÃ§Ã£o automÃ¡tica desabilitada"
(Mensagem rÃ¡pida, 3 segundos)
```

### Em Caso de Erro:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Erro                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ NÃ£o foi possÃ­vel alterar a configuraÃ§Ã£o    â”‚
â”‚ de inicializaÃ§Ã£o automÃ¡tica.                â”‚
â”‚                                             â”‚
â”‚ Verifique se vocÃª tem permissÃµes           â”‚
â”‚ administrativas.                            â”‚
â”‚                                             â”‚
â”‚                 [ OK ]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ CÃ³digo de ReferÃªncia

### CriaÃ§Ã£o do Menu:
```python
# Submenu: InicializaÃ§Ã£o
inicializacao_submenu = tarefas.addMenu("ğŸš€ InicializaÃ§Ã£o")

# AÃ§Ã£o: Iniciar com Windows (checkbox)
self._act_iniciar_windows = QAction("Iniciar automaticamente com o Windows", self)
self._act_iniciar_windows.setCheckable(True)
self._act_iniciar_windows.setChecked(self.startup_manager.is_startup_enabled())
self._act_iniciar_windows.triggered.connect(self._toggle_startup_menu)
inicializacao_submenu.addAction(self._act_iniciar_windows)
```

### Toggle da Funcionalidade:
```python
def _toggle_startup_menu(self):
    """Habilita/desabilita inicializaÃ§Ã£o automÃ¡tica"""
    success = self.startup_manager.toggle_startup()
    
    # Atualiza checkbox
    self._act_iniciar_windows.setChecked(
        self.startup_manager.is_startup_enabled()
    )
    
    # Sincroniza com menu tray
    self._update_startup_action_text()
    
    # Mostra mensagem ao usuÃ¡rio
    if success:
        self.set_status(f"âœ“ InicializaÃ§Ã£o automÃ¡tica ativada", 3000)
```

## ğŸ“Š Fluxo de Uso

```
UsuÃ¡rio clica no menu
        â†“
ConfiguraÃ§Ãµes â†’ ğŸš€ InicializaÃ§Ã£o
        â†“
Marca/Desmarca "Iniciar automaticamente..."
        â†“
Sistema chama _toggle_startup_menu()
        â†“
StartupManager.toggle_startup()
        â†“
Altera registro do Windows
        â†“
Atualiza interface (checkbox + tray)
        â†“
Mostra mensagem de confirmaÃ§Ã£o
        â†“
Salva estado
```

## ğŸ§ª Como Testar

1. **Abrir menu:**
   ```
   ConfiguraÃ§Ãµes â†’ ğŸš€ InicializaÃ§Ã£o
   ```

2. **Marcar checkbox:**
   - Deve abrir mensagem de confirmaÃ§Ã£o
   - Checkbox deve ficar marcado
   - Menu tray deve sincronizar

3. **Verificar registro:**
   ```powershell
   reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Run" /v "BOT Busca NFE"
   ```
   Deve retornar:
   ```
   BOT Busca NFE    REG_SZ    "C:\...\Busca XML.exe" --startup
   ```

4. **Desmarcar checkbox:**
   - Checkbox deve desmarcar
   - Status bar deve mostrar mensagem
   - Registro deve ser removido

5. **Verificar Windows:**
   - Abrir: ConfiguraÃ§Ãµes > Aplicativos > InicializaÃ§Ã£o
   - "BOT Busca NFE" deve aparecer na lista
   - Estado deve corresponder ao checkbox

## âœ… ValidaÃ§Ã£o

- âœ… Menu criado no local correto
- âœ… Checkbox funcional
- âœ… SincronizaÃ§Ã£o com tray menu
- âœ… Mensagens informativas
- âœ… Gerenciador de tarefas acessÃ­vel
- âœ… Item informativo sobre busca automÃ¡tica
- âœ… Ãcones apropriados
- âœ… Estado persistido no registro

---

**Autor:** Sistema Implementado
**Data:** 11/01/2026
**VersÃ£o:** 1.1.0
