# ğŸ“Š Como as NFS-e Aparecem na Interface

## âœ… Status Atual

As NFS-e jÃ¡ estÃ£o **100% integradas** e aparecerÃ£o automaticamente na interface principal ([Busca NF-e.py](Busca%20NF-e.py)) junto com NF-e e CT-e!

---

## ğŸ–¥ï¸ VisualizaÃ§Ã£o na Interface

### Tabela Principal (Busca NF-e.py)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tipo: [Todos â–¼]  NFS-e aparece aqui!                                              â”‚
â”‚        â””â”€ NFe                                                                       â”‚
â”‚        â””â”€ CTe                                                                       â”‚
â”‚        â””â”€ NFS-e  â† NOVO! âœ¨                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                     â”‚
â”‚  NÃºmero          Emitente              DestinatÃ¡rio          Data        Valor     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  ğŸŸ¢ 2500000001578  GLOBAL CREDIT        MATPARCG IND...      2025-01-02  R$ 30.88  â”‚
â”‚  ğŸŸ¢ 114            OZEIAS PEREIRA       MATPARCG IND...      2024-11-29  R$ 2.439  â”‚
â”‚  ğŸŸ¢ 106            OZEIAS PEREIRA       MATPARCG IND...      2024-11-19  R$ 120    â”‚
â”‚  ğŸŸ¢ 100            OZEIAS PEREIRA       MATPARCG IND...      2024-11-01  R$ 1.200  â”‚
â”‚  ğŸŸ¢ 343            ANDRE LUIZ PANIAGO   MATPARCG IND...      2024-10-08  R$ 320    â”‚
â”‚                                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š EstatÃ­sticas de Documentos

ApÃ³s a integraÃ§Ã£o, a interface mostrarÃ¡:

| Tipo     | Quantidade | Valor Total       |
|----------|------------|-------------------|
| **NFe**  | 2.661      | R$ 4.262.646,18  |
| **CTe**  | 768        | R$ 0,00          |
| **NFS-e**| 87         | R$ 78.610,06     | âœ¨ NOVO!

**Total Geral:** 3.516 documentos

---

## ğŸ” Filtros DisponÃ­veis

### 1. Filtro por Tipo
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tipo: [Todos â–¼] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¡ Todos         â”‚
â”‚ â–¡ NFe           â”‚
â”‚ â–¡ CTe           â”‚
â”‚ â˜‘ NFS-e         â”‚ â† Selecionar para ver sÃ³ NFS-e
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Filtro por Data
```
De: [01/01/2024] AtÃ©: [31/12/2024]
```

### 3. Busca por Texto
```
ğŸ” Buscar: [GLOBAL CREDIT]  â†’ Encontra prestadores/tomadores
```

---

## ğŸ“„ Detalhes da NFS-e (Double-Click)

Ao clicar duas vezes em uma NFS-e, abrirÃ¡ janela com:

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  DETALHES DA NFS-e - NÃºmero: 2500000001578                   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                               â•‘
â•‘  ğŸ“ Dados Gerais                                             â•‘
â•‘  â”œâ”€ NÃºmero: 2500000001578                                   â•‘
â•‘  â”œâ”€ Data EmissÃ£o: 02/01/2025                                â•‘
â•‘  â”œâ”€ Valor: R$ 30,88                                         â•‘
â•‘  â”œâ”€ MunicÃ­pio: Belo Horizonte/MG                            â•‘
â•‘  â””â”€ Status: AUTORIZADA                                      â•‘
â•‘                                                               â•‘
â•‘  ğŸ¢ Prestador (Emitente)                                     â•‘
â•‘  â”œâ”€ Nome: GLOBAL CREDIT SISTEMAS LTDA                        â•‘
â•‘  â”œâ”€ CNPJ: 13.891.738/0001-38                                â•‘
â•‘  â””â”€ IM: 02945540015                                         â•‘
â•‘                                                               â•‘
â•‘  ğŸ‘¤ Tomador (DestinatÃ¡rio)                                   â•‘
â•‘  â”œâ”€ Nome: MATPARCG IND COM ESTRUTURAS PRE MOLDADAS           â•‘
â•‘  â”œâ”€ CNPJ: 33.251.845/0001-09                                â•‘
â•‘  â””â”€ MunicÃ­pio: Campo Grande/MS                               â•‘
â•‘                                                               â•‘
â•‘  ğŸ’° Valores                                                  â•‘
â•‘  â”œâ”€ Valor ServiÃ§os: R$ 30,88                                â•‘
â•‘  â”œâ”€ AlÃ­quota ISS: 2,50%                                     â•‘
â•‘  â”œâ”€ Valor ISS: R$ 0,77                                      â•‘
â•‘  â””â”€ Valor LÃ­quido: R$ 30,88                                 â•‘
â•‘                                                               â•‘
â•‘  ğŸ“‹ AÃ§Ãµes                                                    â•‘
â•‘  [Visualizar XML]  [Salvar XML]  [Download DANFSE (PDF)]    â•‘
â•‘                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ¨ IdentificaÃ§Ã£o Visual

### Ãcones por Tipo de Documento

- ğŸ“„ **NFe** - Nota Fiscal EletrÃ´nica (verde)
- ğŸšš **CTe** - Conhecimento de Transporte (azul)
- ğŸ“‹ **NFS-e** - Nota Fiscal de ServiÃ§o (roxo) âœ¨ NOVO!

### Cores de Status

| Status      | Cor    | Ãcone |
|-------------|--------|-------|
| AUTORIZADA  | ğŸŸ¢ Verde | âœ“ |
| CANCELADA   | ğŸ”´ Vermelha | âœ— |
| DENEGADA    | ğŸŸ¡ Amarelo | âš  |

---

## ğŸ“ Estrutura de Arquivos

As NFS-e serÃ£o salvas em:

```
xmls/
â””â”€â”€ {CNPJ_Prestador}/
    â””â”€â”€ {MM-YYYY}/
        â””â”€â”€ NFSe/
            â”œâ”€â”€ NFSe_2500000001578.xml
            â”œâ”€â”€ NFSe_114.xml
            â”œâ”€â”€ NFSe_106.xml
            â””â”€â”€ ...
```

**Exemplo:**
```
xmls/33251845000109/01-2025/NFSe/NFSe_2500000001578.xml
```

---

## ğŸ”„ AtualizaÃ§Ã£o AutomÃ¡tica

### Busca Incremental (PadrÃ£o)
Ao clicar no botÃ£o **"Busca na Sefaz"**:
1. âœ… Busca novos documentos (NFe, CTe, NFS-e)
2. âœ… Atualiza tabela automaticamente
3. âœ… NFS-e aparecem junto com os outros documentos

### Busca Completa
Ao clicar no botÃ£o **"Busca Completa"** ou via script:
```bash
python buscar_nfse_auto.py --completa
```
1. ğŸ”„ Busca TODAS as NFS-e desde o inÃ­cio
2. ğŸ”„ Atualiza registros existentes
3. ğŸ”„ Popula interface automaticamente

---

## ğŸ’¾ Dados Armazenados

### Banco de Dados: `notas.db`

**Tabela: `notas_detalhadas`**

| Campo             | NFS-e Exemplo                          |
|-------------------|----------------------------------------|
| chave             | NFSE_2500000001578_13891738000138     |
| nome_emitente     | GLOBAL CREDIT SISTEMAS LTDA            |
| cnpj_emitente     | 13891738000138                         |
| numero            | 2500000001578                          |
| data_emissao      | 2025-01-02                             |
| **tipo**          | **NFS-e** âœ¨                           |
| valor             | 30.88                                  |
| status            | AUTORIZADA                             |
| cnpj_destinatario | 33251845000109                         |
| nome_destinatario | MATPARCG IND COM ESTRUTURAS...         |
| uf                | MG                                     |
| xml_status        | COMPLETO                               |
| informante        | 13891738000138                         |

---

## ğŸš€ PrÃ³ximos Passos

### âœ… JÃ¡ Implementado
- [x] Busca via Ambiente Nacional
- [x] DecodificaÃ§Ã£o Base64 + gzip
- [x] ExtraÃ§Ã£o de dados do XML
- [x] Salvamento no banco
- [x] IntegraÃ§Ã£o com interface
- [x] Filtro por tipo (NFS-e)
- [x] Busca incremental/completa

### ğŸ”œ PrÃ³ximas Melhorias
- [ ] Download de DANFSE (PDF visual)
- [ ] Visualizador XML especÃ­fico para NFS-e
- [ ] GrÃ¡ficos/relatÃ³rios por tipo de documento
- [ ] ExportaÃ§Ã£o Excel separada por tipo
- [ ] NotificaÃ§Ãµes de novas NFS-e
- [ ] ManifestaÃ§Ã£o de eventos NFS-e

---

## ğŸ¯ Resumo Visual

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  INTERFACE PRINCIPAL (Busca NF-e.py)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  [Busca na Sefaz]  [Busca Completa]  [Exportar]           â”‚
â”‚                                                             â”‚
â”‚  Filtros:  Tipo: [NFS-e â–¼]  De: [____]  AtÃ©: [____]       â”‚
â”‚                                                             â”‚
â”‚  ğŸ“Š Resumo:                                                â”‚
â”‚  â”œâ”€ NFe: 2.661 docs (R$ 4.262.646,18)                     â”‚
â”‚  â”œâ”€ CTe: 768 docs (R$ 0,00)                               â”‚
â”‚  â””â”€ NFS-e: 87 docs (R$ 78.610,06) âœ¨ NOVO!               â”‚
â”‚                                                             â”‚
â”‚  ğŸ“‹ Lista de Documentos:                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Tipo  NÃºmero    Emitente         Data       Valor    â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ ğŸ“‹ 2500000001578 GLOBAL CREDIT  2025-01-02  R$ 30.88 â”‚ â”‚
â”‚  â”‚ ğŸ“‹ 114         OZEIAS PEREIRA   2024-11-29  R$ 2.439 â”‚ â”‚
â”‚  â”‚ ğŸ“‹ 106         OZEIAS PEREIRA   2024-11-19  R$ 120   â”‚ â”‚
â”‚  â”‚ ...                                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  [< Anterior]  PÃ¡gina 1 de 10  [PrÃ³ximo >]                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Como Usar

1. **Abra a interface:**
   ```bash
   python "Busca NF-e.py"
   ```

2. **Filtre por NFS-e:**
   - Clique no dropdown "Tipo"
   - Selecione "NFS-e"

3. **Busque novas NFS-e:**
   - Clique em "Busca na Sefaz" (incremental)
   - Ou execute: `python buscar_nfse_auto.py`

4. **Visualize detalhes:**
   - DÃª duplo-clique em qualquer NFS-e da lista

---

**Ãšltima atualizaÃ§Ã£o:** 10/01/2026  
**Total de NFS-e na interface:** 87 documentos (R$ 78.610,06)
